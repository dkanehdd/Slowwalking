<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="member.MypageImpl">
<!--  
	Mapper에서 파라미터를 처리하는 두번재 방법으로 
	전달되는 순서대로 index형태로 사용한다. 0부터 시작한다. 
-->
	<!-- 프로필 -->
	<select id="profile" resultType="member.MemberDTO">
		SELECT * FROM member WHERE id=#{0}
	</select>
	<update id="proEdit">
		UPDATE member
			SET pw=#{pw}, phone=#{phone}, email=#{email}
			WHERE id=#{id}
	</update>
	<select id="getImage" resultType="member.MemberDTO">
		SELECT image_path, flag FROM member WHERE id=#{0}
	</select>
	
	<!-- 인터뷰 -->
	<insert id="addInterList">
		INSERT INTO interview (idx, parents_id, sitter_id, request_time, parents_agree, sitter_agree, request_idx)
			VALUES (seq_interview_idx.nextval, #{1}, #{2}, #{3}, 'F', 'F', #{0})
	</insert>
	<select id="interList" resultType="advertisement.InterviewDTO">
		SELECT * FROM interview WHERE idx=#{0}
	</select>
	<select id="sitInterList" resultType="advertisement.InterviewDTO">
		SELECT * FROM interview WHERE sitter_id=#{0} ORDER BY idx DESC
	</select>
	<select id="parInterList" resultType="advertisement.InterviewDTO">
		SELECT * FROM interview WHERE parents_id=#{0} ORDER BY idx DESC
	</select>
	<delete id="delInterList">
		DELETE FROM interview WHERE idx=#{0}
	</delete>
	<!-- 수락 상태 변경 -->
	<update id="sitAgree">
		UPDATE interview SET sitter_agree='T' WHERE idx=#{idx}
	</update>
	<update id="parAgree">
		UPDATE interview SET parents_agree='T' WHERE idx=#{idx}
	</update>
	<!-- 알림장 -->
<!-- 	<insert id="addDiary"> -->
<!-- 		INSERT INTO diary (regidate, send_id, rece_id, content, flag, idx) -->
<!-- 			VALUES (to_date(), #{1}, #{2}, #{3}, 'diary', #{0}) -->
<!-- 	</insert> -->
	<select id="viewDiary" resultType="mutiBoard.DiaryDTO">
		SELECT * FROM diary WHERE idx=#{idx}
	</select>
</mapper>